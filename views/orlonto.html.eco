<!DOCTYPE html>
<html>
  <head>
    <title>Huvis Graph Visualization</title>
    <link href="/css/huvis.css" rel="stylesheet" type="text/css">
    <link href="/css/huvis_controls.css" rel="stylesheet" type="text/css">
    <link href="/css/lariat.css" rel="stylesheet" type="text/css">
    <link href="/css/CRRT.css" rel="stylesheet" type="text/css">
    <link href="/css/gclui.css" rel="stylesheet" type="text/css">
    <link href="/css/help.css" rel="stylesheet" type="text/css">
    <link href="/css/jquery-ui.css" rel="stylesheet"/>
    <script src="/node_modules/async/lib/async.js"></script>
  <% if @is_local: %>
    <script src="/vendor/jquery.js"></script>
    <script src="/vendor/d3.v3.min.js"></script>
    <script src="/vendor/jquery-ui.min.js"></script>
  <% else: %>
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
    <script src="//d3js.org/d3.v3.js" charset="utf-8"></script>
    <script src="//ajax.googleapis.com/ajax/libs/jqueryui/1.11.1/jquery-ui.min.js"></script>
  <% end %>  
  </head>
  <body>
    <div id="snippet_box">
    </div>
  <section role="controls" id="tabs">
    <ul style="font-size:80%">
       <li><a href="#tabs-help" title="Introduction and Usage">Help</a></li>
       <li><a href="#tabs-options" title="Fine tune sizes, lengths and thicknesses.">Settings</a></li>
       <li><a href="#huvis_controls" title="Power tools for controlling the graph with commands consisting of verbs and nouns.">Commands</a></li>
       <li><a href="#tabs-history" title="The history of commands">History</a></li>
       <li><a href="#tabs-hide" title="Shrink this menu for maximum room to play.">Hide</a></li>
    </ul>
    <div id="tabs-help" class="scrolling_tab"> 
      <h1>
        HuViz 
        <% if @git_commit_hash: %>
          <sup class="git_commit_hash">
            <a target="huviz_version" href="https://github.com/smurp/huviz/commit/<%= @git_commit_hash %>"><%= @git_commit_hash %></a>
          </sup>
        <% end %>
      </h1>
      <h2>Orlando Ontology Explorer</h2>
      <div class="huviz-versions">
        <a href="http://orlando.dev.semandra.com" 
           class="git-branch-is-master <% if @git_branch_name is 'master':%>current-git-branch<% end %>">production</a>
        <a href="http://beta.orlando.dev.semandra.com" 
           class="git-branch-is-beta  <% if @git_branch_name is 'beta':%>current-git-branch<% end %>">beta</a>
        <a href="http://alpha.orlando.dev.semandra.com" 
           class="git-branch-is-alpha  <% if @git_branch_name is 'alpha':%>current-git-branch<% end %>">alpha</a>
        <a href="/tests">tests</a>
        <a href="/orlonto.html">ontology</a>
      </div>
      <p>This is a visualization of the ontology used by the Orlando project.</p>
    </div>
    <div id="tabs-history" class="scrolling_tab">
    </div>
    <div id="tabs-options" class="graph_controls" >
      <div>
        <label title="the amount bigger than a normal label the currently selected one is">
          focused node mag.
	  <input name="focused_mag" type="range"
                 value="1.4" min="1" max="3" step=".1"
                 onchange="HVZ.update_graph_settings(this)">
        </label>
      </div>
      <div>
        <label title="the size of the font">
          label size (em)
  	  <input name="label_em" type="range" 
                 value=".9" min=".2" max="4" step=".1"
                 onchange="HVZ.update_graph_settings(this)">
        </label>
      </div>
      <div>
        <label title="the size of the snippet text">
          snippet body (em)
  	  <input name="snippet_body_em" type="range" 
                 value=".7" min=".2" max="4" step=".1"
                 onchange="HVZ.update_graph_settings(this)">
        </label>
      </div>
      <div>
        <label title="the size of the snippet triples">
          snippet triple (em)
  	  <input name="snippet_triple_em" type="range" 
                 value=".5" min=".2" max="4" step=".1"
                 onchange="HVZ.update_graph_settings(this)">
        </label>
      </div>
      <div>
        <label title="the repulsive charge between nodes">
          charge (-)
	  <input name="charge" type="range"
                 value="-183" max="-1" min="-200" step="1"
                 onchange="HVZ.update_graph_settings(this)">
        </label>
      </div>
      <div>
        <label title="the attractive force keeping nodes centered">
          gravity
	  <input name="gravity" type="range"
                 value="0.2" min="0" max="1" step=".025"
                 onchange="HVZ.update_graph_settings(this)">
        </label>
      </div>
      <div>
        <label title="how big the shelf is">
          shelf radius
	  <input name="shelf_radius" type="range"
                 value="0.9" min="0.1" max="3" step=".05"
                 onchange="HVZ.update_graph_settings(this)">
        </label>
      </div>
      <div>
        <label title="how much magnification happens">
          fisheye zoom
	  <input name="fisheye_zoom" type="range"
                 value="6.0" min="1" max="20" step=".2"
                 onchange="HVZ.update_graph_settings(this)">
        </label>
      </div>
      <div>
        <label title="how big the fisheye is">
          fisheye radius
	  <input name="fisheye_radius" type="range"
                 value="100" min="40" max="2000" step="20"
                 onchange="HVZ.update_graph_settings(this)">
        </label>
      </div>
      <div>
        <label title="how fat the nodes are">
          node radius
	  <input name="node_radius" type="range"
                 value="3" min=".2" max="8" step=".1"
                 onchange="HVZ.update_graph_settings(this)">
        </label>
      </div>
      <div>
        <label title="how long the lines are">
          link distance
	  <input name="link_distance" type="range"
                 value="125" min="5" max="200" step="2"
                 onchange="HVZ.update_graph_settings(this)">
        </label>
      </div>
      <div>
        <label title="how thick the lines are">
          line thickness
	  <input name="edge_width" type="range"
                 value="1" min="0.2" max="10" step=".2"
                 onchange="HVZ.update_graph_settings(this)">
        </label>
      </div>
      <div>
        <label title="how ">
          line edge weight
	  <input name="line_edge_weight" type="range"
                 value=".2" min="0" max="2" step=".01"
                 onchange="HVZ.update_graph_settings(this)">
        </label>
      </div>
      <div>
        <label title="how much curvature lines have">
          sway fraction
	  <input name="swayfrac" type="range"
                 value="0.22" min="0.001" max=".4" step=".01"
                 onchange="HVZ.update_graph_settings(this)">
        </label>
      </div>
      <div>
        <label title="whether graphed nodes are always labelled">
          label graphed nodes
	  <input name="label_graphed" type="checkbox" checked="checked"
                 onchange="HVZ.update_graph_settings(this)">
        </label>
      </div>
      <div>
        <label title="whether edges have their snippet count shown as (#)">
          snippet count on edge labels
	  <input name="snippet_count_on_edge_labels" type="checkbox"
                 onchange="HVZ.update_graph_settings(this)">
        </label>
      </div>
      <div>
        <label title="whether repositioning already graphed nodes pins them at the new spot">
          nodes pinnable
	  <input name="nodes_pinnable" type="checkbox" checked="checked"
                 onchange="HVZ.update_graph_settings(this)">
        </label>
      </div>
    </div>

    <div id="huvis_controls">
      <div>
        <label title="which file to load">
          data set
          <select 
              name="data_set" class="file_picker"
              onchange="HVZ.load_file(this)" 
              title="data sets are in order of increasing complexity">
	    <option value=""> -- pick -- </option>
            <option title="Orlando ontology" value="/data/orlando_ontology.ttl">OrlOnto - Draft3</option>
            <option title="Orlando Ontology" value="/data/OrlandoOntology-SexesUnderPerson.ttl">OrlOnto - Sexes Under Person</option>
          </select>
        </label>
        <span>
          <button id="reset_btn" style="display:none" type="button" onclick="HVZ.reset_data(this)">
            reset
          </button>
        </span>
      </div>

      <div id="gclui"></div>
    </div>
  </section>
    <div id="vis" class="underneath" style="z-index:-3"></div>
    <div id="viscanvas" class="underneath"></div>
    <pre id="status"></pre>
    <div id="state_msg_box"></div>

    <script src="/huviz/huviz.js?23234"></script>
    <script>
      document.addEventListener('touchmove', function(e) {
        e.preventDefault();
      }, false);

      var HVZ;
      window.addEventListener('load',function(){
        huviz = require('huviz');
        HVZ = new huviz.OntoViz();
        HVZ.boot_sequence();
      });

    </script>
  </body>
</html>

